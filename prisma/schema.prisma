datasource db {
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

model User {
  id            String   @id @default(uuid())
  email         String   @unique
  password_hash String
  created_at    DateTime @default(now())
  apps          App[]
}

model App {
  id          String   @id @default(uuid())
  userId      String   @map("user_id")
  user        User     @relation(fields: [userId], references: [id])
  name        String
  logoUrl     String?
  target_url  String
  description String?
  themeColor  String?
  apkUrl      String?
  customDomain String? @unique
  screenshots String[]
  averageRating Float   @default(0)
  totalReviews  Int     @default(0)
  created_at  DateTime @default(now())
  subscriptions PushSubscription[]
  reviews      Review[]
}

model PushSubscription {
  id          String   @id @default(uuid())
  app_id      String
  app         App      @relation(fields: [app_id], references: [id])
  endpoint    String
  keys_auth   String
  keys_p256dh String
  created_at  DateTime @default(now())
}

model Review {
  id         String   @id @default(uuid())
  app_id     String
  app        App      @relation(fields: [app_id], references: [id])
  userName   String
  rating     Int
  comment    String   @db.Text
  created_at DateTime @default(now())
}
